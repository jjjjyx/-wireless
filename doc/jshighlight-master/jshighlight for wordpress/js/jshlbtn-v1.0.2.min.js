function JSHLInput(h){var c=function(j){return document.getElementById(j);},a=function(j){return j.replace(/^\s*|\s*$/g,"");};var b=(globalLang||"html|css|javascript").split(/\s*\|\s*/),g=b.length,f=0,i=[],d="";for(;f<g;f+=1){d=a(b[f]);i.push('<option value="',d,'"',d==jshl_default_lang?" selected":"",">",d,"</option>");}if(!c("jshl-inputForm")){this.form=document.createElement("div");this.form.id="jshl-inputForm";this.form.className="inputForm";this.callback=h;this.form.innerHTML='<form onsubmit="return false;" id="addform"><div class="title" id="jshl-title"></div><label for="lang">Language: </label><select id="jshl-lang" class="w150">'+i.join("")+'</select><br/><label for="code">The Code: </label><br/><textarea id="jshl-code" placeholder="//Your code here..."></textarea><br/><button class="btn" id="jshl-submit">Submit</button><button class="btn" id="jshl-cancel">Cancel</button></form>';document.body.appendChild(this.form);}else{}this.show=function(){this.form.style.display="block";};this.hide=function(){this.form.style.display="none";};this.code=c("jshl-code");this.lang=c("jshl-lang");this.code=c("jshl-code");this.cancel=c("jshl-cancel");this.submit=c("jshl-submit");var e=this;this.init=function(){this.show();this.cancel.onclick=function(){e.hide();e.lang.value="javascript";e.code.value="";};this.submit.onclick=function(){if(e.callback){e.callback(e.lang.value,e.code.value);}e.hide();e.lang.value="javascript";e.code.value="";};this.code.onkeydown=function(k){k=k||window.event;if(k.keyCode==9){k.preventDefault&&k.preventDefault();k.returnValue=false;if(document.all){document.selection.createRange().text="    ";return false;}var j=this.selectionStart;this.value=this.value.substring(0,this.selectionStart)+"    "+this.value.substring(this.selectionEnd);this.selectionEnd=j+4;return false;}};};this.init();}var jshlinput=null;(function(){tinymce.create("tinymce.plugins.jshlBtn",{init:function(a,b){a.addButton("jshlBtn",{title:"Insert Code",image:b+"/../images/code.png",onclick:function(){var e=a.selection,f=e.getNode(),c=/pre/ig.test(f.nodeName);function d(g,h){if(!h){return false;}h=h.replace(/</g,"&lt;").replace(/>/g,"&gt;");if(e.getNode().nodeName==="PRE"){e.getNode().innerHTML=h;e.getNode().setAttribute("data-language",g);}else{e.setContent('<pre class="jshl_code" data-language="'+g+'">'+h+"</pre>");}}if(!jshlinput){jshlinput=new JSHLInput(d);}else{jshlinput.show();}if(c){jshlinput.code.value=f.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">");jshlinput.lang.value=f.getAttribute("data-language");}}});},createControl:function(b,a){return null;}});tinymce.PluginManager.add("jshlBtn",tinymce.plugins.jshlBtn);})();